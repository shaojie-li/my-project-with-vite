---
id: images
title: Docker镜像讲解
sidebar_label: Docker镜像讲解
---

### 镜像事什么
镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时、库、环境变量以及配置文件等。
所有应用直接打包docker镜像，就可以直接跑起来！
如何得到镜像：
* 从远程仓库下载
* 自己制作一个镜像
* 别人拷贝给你

### Dokcer镜像加载原理
>UnionFs（联合文件系统）

我们下载的时候，看到的一层层的信息，就是这个！
union文件系统（UnionFs）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件下。Union文件系统是Docker镜像的基础，镜像可以通过分层来进行继承，基于基础镜像，可以制作各种具体的应用镜像。

**特性：**一次同时加载多个文件系统，但从外面看来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录。

>Docker镜像加载原理

　　Docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFs。
　　
　　Bootfs（boot-file system）主要包含bootloader和kernel，bootloader主要是引导加载kernel，Linux刚启动时会加载bootfs文件系统，在Docker镜像的最底层是bootfs，这一层与我们典型的Linux/unix系统是一样的，包含boot加载器和内核，当boot加载完成之后整个内核就能在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。
　　
　　Rootfs（root-file system），在bootfs之上，包含的就是典型Linux系统中的/dev、/proc、/bin、/etc等标准目录和文件，rootfs就是各种不同操作系统的发行版，比如Ubuntu，Centos等等。
　　
　　对于一个精简的OS，rootfs可以很小，只需要包括最基本的命令、工具和程序就可以了，因为底层直接用宿主机的内核，自己只需要提供rootfs就可以了，因此可见，对于不用的Linux发行版，bootfs基本是一致的，而rootfs会有差别，因此不同的发行版可以公用bootfs。
　　
### 分层理解
我们可以去下载一个镜像，注意观察下载的日志输出，可以看到是一层一层的在下载。

docker的镜像下载为什么要采用这种一层一层的下载呢？

多个镜像从相同的父镜像构建而来，那么宿主机只需在磁盘上保存一份父镜像，同时内存中也只需加载一份父镜像就可以为所有容器服务了，并且镜像的每一层都可以被共享。

>特点

Docker镜像都是只读的，当容器启动时，一个新的可写层被加载到镜像顶部。这一层就是我们通常说的容器层，容器之下的都叫镜像层。
　　
### commit镜像
如何提交一个自己的镜像？

```shell
docker commit 提交容器成为一个新的副本

docker commit -m="提交的描述信息" -a="作者" 容器id 目标镜像名:[TAG]

# 实战测试
1、启动一个默认的tomcat
2、发现这个默认的tomcat是没有webapps应用的，因为镜像默认的webapps下面是没有文件的
3、我们自己拷贝进去了基本文件才能运行
4、将我们操作过的容器 commit 提交为一个镜像！我们以后就可以使用我们修改过的这个镜像即可！
```

　　



